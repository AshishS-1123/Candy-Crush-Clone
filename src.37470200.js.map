{"version":3,"sources":["../src/ts/Signal.ts","services/SpritePool.ts","EventBus.ts","models/Cells/MultiColoredCell.ts","models/Cells/HardCell.ts","setup.ts","utils/specialCandyHandler.ts","models/Cells/StripedCell.ts","controllers/CandyMatchHandler.ts","controllers/EventHandler.ts","controllers/SwapHandler.ts","utils/random.ts","models/Cells/SimpleCell.ts","models/Cells/CandySourceCell.ts","utils/boardGenerator.ts","models/Board.ts","../node_modules/process/browser.js","../node_modules/tween.ts/dist/tween.esm.js","views/GravityAnimationView.ts","views/ScoreView.ts","views/SwapAnimationView.ts","views/CanvasView.ts","controllers/CandyDestroyer.ts","controllers/GravityHandler.ts","index.ts"],"names":["process","module","exports","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","setTimeout","e","clearTimeout","runTimeout","fun","call","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","nextTick","args","Array","arguments","i","push","Item","array","prototype","apply","title","env","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","NOW","self","hrtime","time","performance","undefined","now","bind","Date","getTime","NOW$1","Group","_tweens","_tweensAddedDuringUpdate","getAll","_this","Object","keys","map","tweenId","removeAll","add","tween","getId","remove","update","preserve","tweenIds","playing","Easing","Linear","None","amount","Quadratic","In","Out","InOut","Cubic","Quartic","Quintic","Sinusoidal","Math","cos","PI","sin","Exponential","pow","Circular","sqrt","Elastic","Back","s","Bounce","Interpolation","v","k","m","f","floor","fn","Utils","Bezier","b","n","pw","bn","Bernstein","CatmullRom","p0","p1","t","fc","Factorial","a","p2","p3","v0","v1","t2","t3","Sequence","_nextId","nextId","Tween","object","groupRef","paused","pauseStart","valuesStart","valuesEnd","valuesStartRepeat","durationValue","repeatValue","yoyoValue","reversed","delayTime","startTime","easingFunction","interpolationFunction","chainedTweens","onStartCallbackFired","id","TWEEN","inject","instance","isPlaying","isPaused","to","properties","duration","create","value","start","parseFloat","property","stop","onStopCallback","stopChainedTweens","end","Infinity","pause","resume","numChainedTweens","group","delay","repeat","times","repeatDelay","repeatDelayTime","yoyo","easing","interpolation","chain","tweens","_i","onStart","callback","onStartCallback","onUpdate","onUpdateCallback","onRepeat","onRepeatCallback","onComplete","onCompleteCallback","onStop","elapsed","charAt","isFinite","tmp","VERSION","__extends","extendStatics","d","setPrototypeOf","__proto__","p","hasOwnProperty","__","constructor","Main","_super"],"mappings":"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","file":"src.37470200.js","sourceRoot":"../src","sourcesContent":[null,"import EMPTY_CELL from '~images/EmptyCell.png';\n\nimport BLUE_CANDY from '~/images/SimpleCandies/Blue_Simple.png';\nimport GREEN_CANDY from '~/images/SimpleCandies/Green_Simple.png';\nimport ORANGE_CANDY from '~/images/SimpleCandies/Orange_Simple.png';\nimport PURPLE_CANDY from '~/images/SimpleCandies/Purple_Simple.png';\nimport RED_CANDY from '~/images/SimpleCandies/Red_Simple.png';\nimport YELLOW_CANDY from '~images/SimpleCandies/Yellow_Simple.png';\n\nimport BLUE_H_CANDY from '~/images/StripedCandies/Horizontal/Blue.png';\nimport GREEN_H_CANDY from '~/images/StripedCandies/Horizontal/Green.png';\nimport ORANGE_H_CANDY from '~/images/StripedCandies/Horizontal/Orange.png';\nimport PURPLE_H_CANDY from '~/images/StripedCandies/Horizontal/Purple.png';\nimport RED_H_CANDY from '~/images/StripedCandies/Horizontal/Red.png';\nimport YELLOW_H_CANDY from '~/images/StripedCandies/Horizontal/Yellow.png';\n\nimport BLUE_V_CANDY from '~/images/StripedCandies/Vertical/Blue.png';\nimport GREEN_V_CANDY from '~/images/StripedCandies/Vertical/Green.png';\nimport ORANGE_V_CANDY from '~/images/StripedCandies/Vertical/Orange.png';\nimport PURPLE_V_CANDY from '~/images/StripedCandies/Vertical/Purple.png';\nimport RED_V_CANDY from '~/images/StripedCandies/Vertical/Red.png';\nimport YELLOW_V_CANDY from '~/images/StripedCandies/Vertical/Yellow.png';\n\nimport BLUE_HARD from '~/images/HardCandy/Blue.png';\nimport GREEN_HARD from '~/images/HardCandy/Green.png';\nimport ORANGE_HARD from '~/images/HardCandy/Orange.png';\nimport PURPLE_HARD from '~/images/HardCandy/Purple.png';\nimport RED_HARD from '~/images/HardCandy/Red.png';\nimport YELLOW_HARD from '~/images/HardCandy/Yellow.png';\n\nimport MULTICOLORED from '~/images/SpecialCandies/Multicolored.png';\n\nimport { Colors } from '~/setup';\n\nexport class SpritePool {\n    // Image for empty cell.\n    emptySimple: HTMLImageElement = new Image();\n\n    // Images for simple candies.\n    redSimple: HTMLImageElement = new Image();\n    orangeSimple: HTMLImageElement = new Image();\n    blueSimple: HTMLImageElement = new Image();\n    greenSimple: HTMLImageElement = new Image();\n    yellowSimple: HTMLImageElement = new Image();\n    purpleSimple: HTMLImageElement = new Image();\n    \n    // Images for vertical striped cells.\n    redVStripe: HTMLImageElement = new Image();\n    orangeVStripe: HTMLImageElement = new Image();\n    blueVStripe: HTMLImageElement = new Image();\n    greenVStripe: HTMLImageElement = new Image();\n    yellowVStripe: HTMLImageElement = new Image();\n    purpleVStripe: HTMLImageElement = new Image();\n    \n    // Images for horizontal striped cells.\n    redHStripe: HTMLImageElement = new Image();\n    orangeHStripe: HTMLImageElement = new Image();\n    blueHStripe: HTMLImageElement = new Image();\n    greenHStripe: HTMLImageElement = new Image();\n    yellowHStripe: HTMLImageElement = new Image();\n    purpleHStripe: HTMLImageElement = new Image();\n    \n    // Images for hard candies.\n    redHard: HTMLImageElement = new Image();\n    orangeHard: HTMLImageElement = new Image();\n    blueHard: HTMLImageElement = new Image();\n    greenHard: HTMLImageElement = new Image();\n    yellowHard: HTMLImageElement = new Image();\n    purpleHard: HTMLImageElement = new Image();\n    \n    // Special candies.\n    multicolored: HTMLImageElement = new Image();\n\n    constructor() {\n        this.emptySimple.src = EMPTY_CELL;\n        \n        this.redSimple.src = RED_CANDY;\n        this.orangeSimple.src = ORANGE_CANDY;\n        this.blueSimple.src = BLUE_CANDY;\n        this.greenSimple.src = GREEN_CANDY;\n        this.yellowSimple.src = YELLOW_CANDY;\n        this.purpleSimple.src = PURPLE_CANDY;\n        \n        this.redHStripe.src = RED_H_CANDY;\n        this.orangeHStripe.src = ORANGE_H_CANDY;\n        this.blueHStripe.src = BLUE_H_CANDY;\n        this.greenHStripe.src = GREEN_H_CANDY;\n        this.yellowHStripe.src = YELLOW_H_CANDY;\n        this.purpleHStripe.src = PURPLE_H_CANDY;\n        \n        this.redVStripe.src = RED_V_CANDY;\n        this.orangeVStripe.src = ORANGE_V_CANDY;\n        this.blueVStripe.src = BLUE_V_CANDY;\n        this.greenVStripe.src = GREEN_V_CANDY;\n        this.yellowVStripe.src = YELLOW_V_CANDY;\n        this.purpleVStripe.src = PURPLE_V_CANDY;\n        \n        this.redHard.src = RED_HARD;\n        this.orangeHard.src = ORANGE_HARD;\n        this.blueHard.src = BLUE_HARD;\n        this.greenHard.src = GREEN_HARD;\n        this.yellowHard.src = YELLOW_HARD;\n        this.purpleHard.src = PURPLE_HARD;\n        \n        this.multicolored.src = MULTICOLORED;\n    }\n        \n    getSimpleCandy(color: Colors): HTMLImageElement {\n        switch (color) {\n            case 'RED': return this.redSimple;\n            case 'ORANGE': return this.orangeSimple;\n            case 'BLUE': return this.blueSimple;\n            case 'GREEN': return this.greenSimple;\n            case 'YELLOW': return this.yellowSimple;\n            case 'PURPLE': return this.purpleSimple;\n            default: return this.emptySimple;\n        }\n    }\n\n    public getHardCandy(color: Colors): HTMLImageElement {\n        switch (color) {\n            case 'RED': return this.redHard;\n            case 'ORANGE': return this.orangeHard;\n            case 'BLUE': return this.blueHard;\n            case 'GREEN': return this.greenHard;\n            case 'YELLOW': return this.yellowHard;\n            case 'PURPLE': return this.purpleHard;\n            default: return this.emptySimple;\n        }\n    }\n\n    public getStripedVertical(color: Colors): HTMLImageElement {\n        switch (color) {\n            case 'RED': return this.redVStripe;\n            case 'ORANGE': return this.orangeVStripe;\n            case 'BLUE': return this.blueVStripe;\n            case 'GREEN': return this.greenVStripe;\n            case 'YELLOW': return this.yellowVStripe;\n            case 'PURPLE': return this.purpleVStripe;\n            default: return this.emptySimple;\n        }\n    }\n    \n    public getStripedHorizontal(color: Colors): HTMLImageElement {\n        switch (color) {\n            case 'RED': return this.redHStripe;\n            case 'ORANGE': return this.orangeHStripe;\n            case 'BLUE': return this.blueHStripe;\n            case 'GREEN': return this.greenHStripe;\n            case 'YELLOW': return this.yellowHStripe;\n            case 'PURPLE': return this.purpleHStripe;\n            default: return this.emptySimple;\n        }\n    }\n\n    public getMulticolored(): HTMLImageElement {\n        return this.multicolored;\n    }\n}\n","import { Signal } from 'signal-ts';\nimport { CellPos, Vector } from 'setup';\nimport { Board } from './models/Board';\nimport { SpritePool } from './services/SpritePool';\n\nexport namespace EventBus {\n    // Emitted by EventHandler to when cells are clicked.\n    export const cellClickEvent: Signal<Vector> = new Signal();\n\n    // Sent to CandyMatchHandler to check if swapping is allowed.\n    export const swapCellRequest: Signal<{first: Vector, second: Vector, board: Board}> = new Signal();\n\n    // Sent to CandyMatchHandler to check all cells on board for matching candies.\n    export const destroyCandyMatches: Signal<Board> = new Signal();\n\n    // Used for updating board when controllers make changes in board.\n    export const updateBoard: Signal<Board> = new Signal();\n\n    // Updates canvas with the swapped cells.\n    export const renderSwapAnimation: Signal<{first: CellPos, second: CellPos}> = new Signal();\n\n    // Re-render canvas.\n    export const renderBoard: Signal<Board> = new Signal();\n\n    // Destroy candies.\n    export const destroyCandies: Signal<{board: Board, candies: Vector[]}> = new Signal();\n\n    // Apply gravity to board.\n    export const applyGravity: Signal<void> = new Signal();\n\n    // Draw gravity animation on board.\n    export const renderGravityAnimation: Signal<{images: HTMLImageElement[], startPoint: Vector}> = new Signal();\n\n    // For tracking score of user.\n    export const incrementScore: Signal<number> = new Signal();\n    // For tracking moves left of user.\n    export const decrementMoves: Signal<void> = new Signal();\n\n    // Signal to notify that the game is over.\n    export const gameOver: Signal<void> = new Signal();\n}\n\nexport namespace Global {\n    export const spritePool: SpritePool = new SpritePool();\n}","import { CellType, Colors } from \"~/setup\";\nimport { Cell } from \"./Cell\";\n\nimport MULTICOLORED_CANDY from '~/images/SpecialCandies/Multicolored.png';\nimport { Global } from \"~/EventBus\";\n\nexport class MultiColoredCell implements Cell {\n    cellType: CellType;\n    colorType: Colors;\n    image: HTMLImageElement;\n    isVisible: boolean;\n\n    constructor () {\n        this.cellType = 'MULTICOLORED';\n        this.colorType = 'NONE';\n        this.isVisible = true;\n\n        this.image = Global.spritePool.getMulticolored();\n    }\n\n    copy :() => Cell = () => {\n        return new MultiColoredCell();\n    }\n}","import { CellType, Colors } from '~/setup';\nimport { Cell } from './Cell';\nimport { Global } from '~/EventBus';\n\nexport class HardCell implements Cell {\n    cellType: CellType;\n    colorType: Colors;\n    image: HTMLImageElement;\n    isVisible: boolean;\n\n    constructor(color: Colors) {\n        this.cellType = 'HARD';\n        this.colorType = color;\n        this.isVisible = true;\n\n        // this.image.src = assignImageFromColor(color);\n        this.image = Global.spritePool.getHardCandy(color);\n    }\n\n    copy :() => Cell = () => {\n        return new HardCell(this.colorType);\n    }\n}\n","// Define some constants here\n\n// Size of game board.\nexport const BOARD_WIDTH = 500;\nexport const BOARD_HEIGHT = 700;\n\n// Size of cells.\nexport const CELL_WIDTH = 36;\nexport const CELL_HEIGHT = 36;\nexport const CELL_PADDING = 14;\n\n// Rows and columns of candies\nexport const ROWS = Math.floor ( (BOARD_HEIGHT - CELL_PADDING) / (CELL_HEIGHT + CELL_PADDING) );\nexport const COLUMNS = Math.floor ( (BOARD_WIDTH - CELL_PADDING) / (CELL_WIDTH + CELL_PADDING) );\n\n// Number of moves user can make in each round.\nexport const MOVES = 20;\n\n// Colors supported for candies\nexport const RED = 'RED';\nexport const ORANGE = 'ORANGE';\nexport const BLUE = 'BLUE';\nexport const GREEN = 'GREEN';\nexport const YELLOW = 'YELLOW';\nexport const PURPLE = 'PURPLE';\n\nexport type CellType = 'SIMPLE' | 'STRIPED_V' | 'STRIPED_H' | 'HARD' | 'MULTICOLORED' | 'HIDDEN' | 'NONE';\nexport type Colors = 'RED' | 'ORANGE' | 'BLUE' | 'GREEN' | 'YELLOW' | 'PURPLE' | 'EMPTY' | 'NONE';\n\nexport const Scores = {\n  'SIMPLE': 1,\n  'STRIPED_V': 10,\n  'STRIPED_H': 10,\n  'HARD': 15,\n  'MULTICOLORED': 20,\n}\n\nexport const ANIMATION_DURATION = 1000;\nexport const ANIMATION_THROTTLE = 100;\n\n// Represents a pair of values.\nexport type Vector = {\n    x: number,\n    y: number,\n};\n\nexport type CellPos = {\n    pos: Vector,\n    img: HTMLImageElement\n}\n\nexport function delay(delayInms: number): Promise<void> {\n    return new Promise(resolve => {\n      setTimeout(() => {\n        resolve();\n      }, delayInms);\n    });\n}\n","import { Board } from \"~/models/Board\";\nimport { CellType, Colors, Vector } from \"~/setup\";\n\nexport type CandyMatchData = {\n    newCandyType: CellType,\n    newCandyColor: Colors,\n    destroyCandies: Vector[]\n}\n\nexport function checkSpecialCandy (board: Board, pos: Vector): CandyMatchData {\n    let countTop = 0;\n    let countBottom = 0;\n    let countLeft = 0;\n    let countRight = 0;\n\n    // Count the number of adjacent candies with color same as pos above it.\n    for (let i = -1; i > -6; --i) {\n        if (board.getColorAtCell({x: pos.x, y: pos.y + i}) == board.getColorAtCell(pos)) {\n            ++countLeft;\n        } else {\n            break;\n        }\n    }\n\n    // Count the number of adjacent candies with color same as pos below it.\n    for (let i = 1; i < 6; ++i) {\n        if (board.getColorAtCell({x: pos.x, y: pos.y + i}) == board.getColorAtCell(pos)) {\n            ++countRight;\n        } else {\n            break;\n        }\n    }\n\n    // Count the number of adjacent candies with color same as pos left of it.\n    for (let i = -1; i > -6; --i) {\n        if (board.getColorAtCell({x: pos.x + i, y: pos.y}) == board.getColorAtCell(pos)) {\n            ++countTop;\n        } else {\n            break;\n        }\n    }\n    \n    // Count the number of adjacent candies with color same as pos right of it.\n    for (let i = 1; i < 6; ++i) {\n        if (board.getColorAtCell({x: pos.x + i, y: pos.y}) == board.getColorAtCell(pos)) {\n            ++countBottom;\n        } else {\n            break;\n        }\n    }\n\n    // Check if multicolored bomb can be formed.\n    const multicolored = checkMulticolored(countTop, countBottom, countLeft, countRight, pos);\n    if (multicolored.doesForm) {\n        const returnValue: CandyMatchData = {\n            newCandyType: 'MULTICOLORED',\n            newCandyColor: 'BLUE', // Color doesn't matter for multicolored.\n            destroyCandies: multicolored.destroyCandies\n        }\n\n        return returnValue;\n    }\n\n    // Check if hard candy can be formed.\n    const hardCandy = checkHardCandy(countTop, countBottom, countLeft, countRight, pos);\n    if (hardCandy.doesForm) {\n        const returnValue: CandyMatchData = {\n            newCandyType: 'HARD',\n            newCandyColor: board.getColorAtCell (pos),\n            destroyCandies: hardCandy.destroyCandies\n        }\n\n        return returnValue;\n    }\n\n    // Check if striped candy can be formed.\n    const vStripedCandy = checkVStripedCandy(countTop, countBottom, pos);\n    if (vStripedCandy.doesForm) {\n        const returnValue: CandyMatchData = {\n            newCandyType: 'STRIPED_V',\n            newCandyColor: board.getColorAtCell (pos),\n            destroyCandies: vStripedCandy.destroyCandies\n        }\n\n        return returnValue;\n    }\n\n    const hStripedCandy = checkHStripedCandy(countLeft, countRight, pos);\n    if (hStripedCandy.doesForm) {\n        const returnValue: CandyMatchData = {\n            newCandyType: 'STRIPED_H',\n            newCandyColor: board.getColorAtCell (pos),\n            destroyCandies: hStripedCandy.destroyCandies\n        }\n\n        return returnValue;\n    }\n    \n    const returnValue: CandyMatchData = {\n        newCandyType: 'SIMPLE',\n        newCandyColor: board.getColorAtCell (pos),\n        destroyCandies: getDestroyListForSimple(countTop, countBottom, countLeft, countRight, pos)\n    }\n    \n    return returnValue;\n}\n\nfunction checkMulticolored (\n    countTop: number, \n    countBottom: number, \n    countLeft: number, \n    countRight: number, \n    pos: Vector\n): {doesForm: boolean, destroyCandies: Vector[]} {\n    let destroyCandies: Vector[] = [];\n    let doesForm: boolean = false;\n\n    if (countLeft + countRight == 4) {\n        doesForm = true;\n        \n        destroyCandies = [\n            {x: pos.x, y: pos.y - 1},\n            {x: pos.x, y: pos.y - 2},\n            {x: pos.x, y: pos.y + 1},\n            {x: pos.x, y: pos.y + 2},\n        ]\n    } else if (countTop + countBottom == 4) {\n        doesForm = true;\n\n        destroyCandies = [\n            {x: pos.x - 1, y: pos.y},\n            {x: pos.x - 2, y: pos.y},\n            {x: pos.x + 1, y: pos.y},\n            {x: pos.x + 2, y: pos.y},\n        ]\n    }\n\n    return { doesForm, destroyCandies };\n}\n\nfunction checkHardCandy (\n    countTop: number,\n    countBottom: number,\n    countLeft: number,\n    countRight: number,\n    pos: Vector\n): {doesForm: boolean, destroyCandies: Vector[]} {\n    let destroyCandies: Vector[] = [];\n    let doesForm: boolean = false;\n\n    if (countTop + countBottom == 2 && countLeft + countRight == 2) {\n        doesForm = true;\n\n        // Mark all top candies for destroy\n        for (let i = 1; i < countTop + 1; ++i) destroyCandies.push({ x: pos.x - i, y: pos.y});\n\n        // Mark all bottom candies for destroy\n        for (let i = 1; i < countBottom + 1; ++i) destroyCandies.push({ x: pos.x + i, y: pos.y});\n\n        // Mark all left candies for destroy\n        for (let i = 1; i < countLeft + 1; ++i) destroyCandies.push({ x: pos.x, y: pos.y - i});\n\n        // Mark all right candies for destroy\n        for (let i = 1; i < countRight + 1; ++i) destroyCandies.push({ x: pos.x, y: pos.y + i});\n    }\n\n    return {doesForm, destroyCandies};\n}\n\nfunction checkVStripedCandy (\n    countTop: number,\n    countBottom: number,\n    pos: Vector\n): {doesForm: boolean, destroyCandies: Vector[]} {\n    let destroyCandies: Vector[] = [];\n    let doesForm: boolean = false;\n\n    if (countTop + countBottom == 3) {\n        doesForm = true;\n        // Mark all top candies for destroy\n        for (let i = 1; i < countTop + 1; ++i) destroyCandies.push({ x: pos.x - i, y: pos.y});\n\n        // Mark all bottom candies for destroy\n        for (let i = 1; i < countBottom + 1; ++i) destroyCandies.push({ x: pos.x + i, y: pos.y});\n    }\n\n    return {doesForm, destroyCandies};\n}\n\nfunction checkHStripedCandy (\n    countLeft: number,\n    countRight: number,\n    pos: Vector\n): {doesForm: boolean, destroyCandies: Vector[]} {\n    let destroyCandies: Vector[] = [];\n    let doesForm: boolean = false;\n\n    if (countLeft + countRight == 3) {\n        doesForm = true;\n\n        // Mark all left candies for destroy\n        for (let i = 1; i < countLeft + 1; ++i) destroyCandies.push({ x: pos.x, y: pos.y - i});\n\n        // Mark all right candies for destroy\n        for (let i = 1; i < countRight + 1; ++i) destroyCandies.push({ x: pos.x, y: pos.y + i});\n    }\n\n    return {doesForm, destroyCandies};\n}\n\nfunction getDestroyListForSimple (\n    countTop: number,\n    countBottom: number,\n    countLeft: number,\n    countRight: number,\n    pos: Vector\n): Vector[] {\n    const destroyCandies: Vector[] = [];\n\n    // This condition is very similar to HARD candy.\n    // But, in this case, only one of them have to be correct.\n    if (countTop + countBottom == 2) {\n        destroyCandies.push (pos);\n        for (let i = 1; i < countTop + 1; ++i) destroyCandies.push ({x: pos.x - i, y: pos.y});\n        for (let i = 1; i < countBottom + 1; ++i) destroyCandies.push ({x: pos.x + i, y: pos.y});\n    } else if (countLeft + countRight == 2) {\n        destroyCandies.push (pos);\n        for (let i = 1; i < countLeft + 1; ++i) destroyCandies.push ({x: pos.x, y: pos.y - i});\n        for (let i = 1; i < countRight + 1; ++i) destroyCandies.push ({x: pos.x, y: pos.y + i});\n    }\n\n    return destroyCandies;\n}\n","import { CellType, Colors } from '~/setup';\nimport { Cell } from './Cell';\nimport { Global } from '~/EventBus';\n\nexport class StripedCell implements Cell {\n    cellType: CellType;\n    colorType: Colors;\n    image: HTMLImageElement;\n    isVisible: boolean;\n\n    constructor(color: Colors, isVertical: boolean) {\n        this.cellType = isVertical ? 'STRIPED_V' : 'STRIPED_H';\n        this.colorType = color;\n        this.isVisible = true;\n\n        this.image = isVertical ? Global.spritePool.getStripedVertical(color) : Global.spritePool.getStripedHorizontal(color);\n    }\n\n    copy :() => Cell = () => {\n        return new StripedCell(this.colorType, this.cellType === 'STRIPED_V');\n    }\n}\n","import { EventBus } from \"~/EventBus\";\nimport { Board } from \"~/models/Board\";\nimport { MultiColoredCell } from \"~/models/Cells/MultiColoredCell\";\nimport { HardCell } from  '~/models/Cells/HardCell';\nimport { Vector, delay, ANIMATION_DURATION, ANIMATION_THROTTLE, ROWS, COLUMNS, Colors } from \"~/setup\";\nimport { checkSpecialCandy } from \"~/utils/specialCandyHandler\";\nimport { StripedCell } from \"~/models/Cells/StripedCell\";\n\n// Called by SwapHandler to match and destroy candies\nexport class CandyMatchHandler {\n    constructor() {\n        EventBus.swapCellRequest.add (this.handleSwapRequest.bind(this));\n        EventBus.destroyCandyMatches.add (this.handleDestroyCandyMatches.bind(this));\n    }\n\n    handleSwapRequest (params: {first: Vector, second: Vector, board: Board}) {\n        // Check if first or second candy matched.\n        if (this.checkIfCandiesMatch(params.board, params.first) || this.checkIfCandiesMatch(params.board, params.second)) {\n            this.handleCandyMatch(params.board, params.first);\n            this.handleCandyMatch(params.board, params.second);\n\n            EventBus.decrementMoves.emit();\n            return;\n        }\n\n        // If candies did not match, check if multicolored candy was special.\n        const candiesToReplace = this.checkSwapWithSpecialCandy(params.board, params.first, params.second);\n\n        if (candiesToReplace.length !== 0){\n            EventBus.destroyCandies.emit({board: params.board, candies: candiesToReplace});\n            return;\n        }\n\n        delay(ANIMATION_THROTTLE).then (() => {\n            // If candies did not match, emit signal to re swap these cells.\n            EventBus.renderSwapAnimation.emit ({\n                second: {\n                    pos: params.first,\n                    img: params.board.getImageAtCell (params.first)\n                },\n                first: {\n                    pos: params.second,\n                    img: params.board.getImageAtCell (params.second)\n                },\n            });\n        })\n\n        delay(ANIMATION_DURATION).then (() => {\n            // Update the board with this data.\n            const temp = params.board.cells[params.first.x][params.first.y];\n            params.board.cells[params.first.x][params.first.y] = params.board.cells[params.second.x][params.second.y];\n            params.board.cells[params.second.x][params.second.y] = temp;\n    \n            // Update global board class.\n            EventBus.updateBoard.emit (params.board);\n        })\n\n        \n    }\n    // Scans board if there are three in line. Return if three in line.\n    // Used to check whether to swap candies or destroy them.\n    checkIfCandiesMatch (board: Board, cellPos: Vector): boolean {\n        /*\n                          ( top2 )\n                          ( top1 )\n          (left2) (left1) (cellPos) (right1) (right2)\n                          (bottom1)\n                          (bottom2)\n         */\n        // cellPos = {x: cellPos.y, y: cellPos.x};\n        const top1 = {x: cellPos.x - 1, y: cellPos.y};\n        const top2 = {x: cellPos.x - 2, y: cellPos.y};\n        const bottom1 = {x: cellPos.x + 1, y: cellPos.y};\n        const bottom2 = {x: cellPos.x + 2, y: cellPos.y};\n\n        const left1 = {x: cellPos.x, y: cellPos.y - 1};\n        const left2 = {x: cellPos.x, y: cellPos.y - 2};\n        const right1 = {x: cellPos.x, y: cellPos.y + 1};\n        const right2 = {x: cellPos.x, y: cellPos.y + 2};\n        \n        // Check horizontal match with this cell in left.\n        if (board.doCandiesMatch (cellPos, right1) && board.doCandiesMatch(cellPos, right2)) {\n            return true;\n        }\n\n        // Check if horizontal match with this cell in middle.\n        if (board.doCandiesMatch (cellPos, left1) && board.doCandiesMatch(cellPos, right1)) {\n            return true;\n        }\n\n        // Check if horizontal match with this cell in right.\n        if (board.doCandiesMatch (cellPos, left1) && board.doCandiesMatch(cellPos, left2)) {\n            return true;\n        }\n        \n        // Check if vertical match with this cell in top.\n        if (board.doCandiesMatch (cellPos, bottom1) && board.doCandiesMatch(cellPos, bottom2)) {\n            return true;\n        }\n\n        // Check if vertical match with this cell in middle.\n        if (board.doCandiesMatch (cellPos, top1) && board.doCandiesMatch(cellPos, bottom1)) {\n            return true;\n        }\n        \n        // Check if vertical match with this cell in bottom.\n        if (board.doCandiesMatch (cellPos, top1) && board.doCandiesMatch(cellPos, top2)) {\n            return true;\n        }\n        \n        return false;\n    }\n\n    handleCandyMatch (board: Board, position: Vector) {\n        const matchData = checkSpecialCandy (board, position);\n\n        // Replace the current candy with the new candy.\n        switch(matchData.newCandyType) {\n            case 'SIMPLE': break;\n            case 'STRIPED_H':\n                board.cells[position.x][position.y] = new StripedCell(matchData.newCandyColor, false);\n                break;\n            case 'STRIPED_V':\n                board.cells[position.x][position.y] = new StripedCell(matchData.newCandyColor, true);\n                break;\n            case 'HARD':\n                board.cells[position.x][position.y] = new HardCell(matchData.newCandyColor);\n                break;\n            case 'MULTICOLORED': \n                board.cells[position.x][position.y] = new MultiColoredCell();\n                console.log(board.cells[position.x][position.y]);\n                \n                break;\n        }\n        \n        // Update the board and re-render.\n        EventBus.updateBoard.emit (board);\n\n        EventBus.renderBoard.emit (board);\n\n        // Delete the other candies.\n        EventBus.destroyCandies.emit ({\n            board,\n            candies: matchData.destroyCandies\n        });\n    }\n\n    handleDestroyCandyMatches(board: Board) {\n        for (let i = 0; i < ROWS; ++i) {\n            for (let j = 0; j < COLUMNS; ++j) {\n                const pos = {x: i, y: j};\n                if (this.checkIfCandiesMatch(board, pos)) {\n                    this.handleCandyMatch(board, pos);\n                }\n            }\n        }\n    }\n\n    checkSwapWithSpecialCandy(board: Board, first: Vector, second: Vector): Vector[] {\n        const firstType = board.getTypeAtCell(first);\n        const secondType = board.getTypeAtCell(second);\n\n        let replaceColor: Colors = 'NONE';\n\n        // Only handling swapping with mouticolored candy here.\n        if (firstType === 'MULTICOLORED') {\n            replaceColor = board.getColorAtCell(second);\n        } else if (secondType == 'MULTICOLORED') {\n            replaceColor = board.getColorAtCell(first);\n        }\n\n        const candies = this.replaceAllCandies(board, replaceColor);\n        candies.push (firstType === 'MULTICOLORED' ? first : second);\n\n        return candies;\n    }\n\n    replaceAllCandies (board: Board, replaceColor: Colors): Vector[] {\n        const candiesToReplace: Vector[] = [];\n\n        for (let i = 0; i < ROWS; ++i) {\n            for (let j = 0; j < COLUMNS; ++j) {\n                const pos = {x: i, y: j};\n                if (board.getColorAtCell(pos) == replaceColor) {\n                    candiesToReplace.push (pos)\n                }\n            }\n        }\n        return candiesToReplace;\n    }\n}","import { EventBus } from \"~/EventBus\";\nimport { CELL_PADDING, CELL_WIDTH, CELL_HEIGHT, COLUMNS, ROWS } from \"~/setup\";\nimport { CanvasView } from \"~/views/CanvasView\";\n\nconst THRESH = CELL_WIDTH;\n\ntype CallbackFunction = (pos_x: number, pos_y: number) => void;\n\nexport class EventHandler {\n    canvasView: CanvasView;\n    cellClickCallback: CallbackFunction | null;\n\n    constructor(canvasView: CanvasView) {\n        this.canvasView = canvasView;\n        this.cellClickCallback = null;\n        \n        // Add event listeners\n        this.canvasView.canvas.addEventListener('click', this.handleButtonClick);\n        EventBus.gameOver.add(() => {\n            this.canvasView.canvas.removeEventListener('click', this.handleButtonClick);\n        })\n    }\n\n    handleButtonClick: (event: MouseEvent) => void = (event) => {\n        // Convert coordinates to local frame.\n        const rect = this.canvasView.canvas.getBoundingClientRect();\n        const abs_coord_x = event.x - rect.left - CELL_PADDING;\n        const abs_coord_y = event.y - rect.top - CELL_PADDING;\n\n        // Find row and column number for click event.\n        const pos_x = Math.floor( abs_coord_x / (CELL_WIDTH + CELL_PADDING));\n        const pos_y = Math.floor( abs_coord_y / (CELL_HEIGHT + CELL_PADDING));\n\n        // Check that cell is within rows and columns present.\n        if (pos_x < 0 || pos_x >= COLUMNS || pos_y < 0 || pos_y >= ROWS) return;\n\n        // Distance of click from center line of candy must be less than threshold.\n        const cell_coord_x = CELL_PADDING / 2 + (2 * pos_x + 1) * (CELL_WIDTH + CELL_PADDING) / 2;\n        const cell_coord_y = CELL_PADDING / 2 + (2 * pos_y + 1) * (CELL_HEIGHT + CELL_PADDING) / 2;\n        \n        if (\n            Math.abs(cell_coord_x - abs_coord_x) > THRESH ||\n            Math.abs(cell_coord_y - abs_coord_y) > THRESH\n        ) {\n            return;\n        } \n\n        // If everything is ok, then trigger the event in canvas.\n        EventBus.cellClickEvent.emit ({x: pos_y, y: pos_x});\n    }\n}","import { ANIMATION_DURATION, ANIMATION_THROTTLE, delay, Vector } from '~/setup';\nimport { EventBus } from '~/EventBus';\nimport { Board } from '~/models/Board';\nimport { CanvasView } from '~/views/CanvasView';\n\n// Based on events, swap candies, check if they match and destroy them.\nexport class SwapHandler {\n    private board: Board;\n    private firstSelectedCell: Vector | null;\n    private secondSelectedCell: Vector | null;\n\n    constructor(board: Board) {\n        this.board = board;\n\n        this.firstSelectedCell = null;\n        this.secondSelectedCell = null;\n\n        EventBus.cellClickEvent.add (this.handleCellClicked.bind (this));\n        EventBus.updateBoard.add (this.handleAddBoard.bind (this));\n    }\n\n    handleAddBoard (board: Board): void {\n        this.board = board;\n    }\n\n    handleCellClicked (pos: Vector) {\n        const { x: pos_x, y: pos_y } = pos;\n        \n\n        if (!this.firstSelectedCell) {\n            this.firstSelectedCell = {x: pos_x, y: pos_y};\n        } else if (!this.secondSelectedCell) {\n            this.secondSelectedCell = {x: pos_x, y: pos_y};\n\n            // The two cells that are being swapped should be adjacent.\n            if (\n                Math.abs (this.firstSelectedCell.x - this.secondSelectedCell.x) !== 1 &&\n                Math.abs (this.firstSelectedCell.y - this.secondSelectedCell.y) !== 1\n            ) {\n                this.firstSelectedCell = this.secondSelectedCell = null;\n                return;\n            }\n\n            // The two cells should also not be adjacent.\n            if (Math.abs (this.firstSelectedCell.x - this.secondSelectedCell.x) === Math.abs (this.firstSelectedCell.y - this.secondSelectedCell.y)) {\n                this.firstSelectedCell = this.secondSelectedCell = null;\n                return;\n            }\n\n            // Render this on canvas.\n            EventBus.renderSwapAnimation.emit ({\n                first: {\n                    pos: this.secondSelectedCell || {x: -1, y: -1},\n                    img: this.board.getImageAtCell (this.secondSelectedCell)\n                },\n                second: {\n                    pos: this.firstSelectedCell || {x: -1, y: -1},\n                    img: this.board.getImageAtCell (this.firstSelectedCell)\n                },\n            });\n\n            delay(ANIMATION_DURATION).then(this.postAnimationCallback.bind(this));\n        }\n    }\n\n    postAnimationCallback() {\n        if (!this.firstSelectedCell || !this.secondSelectedCell) return;\n\n        // Update the board with this data.\n        const temp = this.board.cells[this.firstSelectedCell.x][this.firstSelectedCell.y];\n        this.board.cells[this.firstSelectedCell.x][this.firstSelectedCell.y] = this.board.cells[this.secondSelectedCell.x][this.secondSelectedCell.y];\n        this.board.cells[this.secondSelectedCell.x][this.secondSelectedCell.y] = temp;\n\n        // Update the global board class.\n        EventBus.updateBoard.emit (this.board);\n\n        EventBus.swapCellRequest.emit ({\n            first: this.firstSelectedCell,\n            second: this.secondSelectedCell,\n            board: this.board\n        });\n\n        // Reset selection after swapping.\n        this.firstSelectedCell = null;\n        this.secondSelectedCell = null;\n    }\n}","export function selectRandomString (possibilities: string[], exceptions: string[] = []) {\n    while (1) {\n        const choice = possibilities[ Math.floor (Math.random() * possibilities.length) ];\n\n        if (!exceptions.find (element => element === choice)) return choice;\n    }\n}","import { CellType, Colors } from '~/setup';\nimport { Cell } from './Cell';\nimport { Global } from '~/EventBus';\n\nexport class SimpleCell implements Cell {\n    cellType: CellType;\n    colorType: Colors;\n    image: HTMLImageElement;\n    isVisible: boolean;\n\n    constructor(color: Colors) {\n        this.cellType = 'SIMPLE';\n        this.colorType = color;\n        this.isVisible = true;\n\n        this.image = Global.spritePool.getSimpleCandy(color);\n    }\n\n    copy :() => Cell = () => {\n        return new SimpleCell(this.colorType);\n    }\n}\n","import { Cell } from './Cell';\nimport { CellType, Colors } from \"~/setup\";\nimport EMPTY_CELL from '~images/EmptyCell.png';\nimport { selectRandomString } from '~/utils/random';\nimport { SimpleCell } from './SimpleCell';\n\nexport class CandySourceCell implements Cell {\n    cellType: CellType;\n    colorType: Colors;\n    image: HTMLImageElement = new Image();\n    isVisible: boolean;\n\n    private previousGeneratedColor: string = 'EMPTY';\n\n    constructor() {\n        this.cellType = 'HIDDEN';\n        this.colorType = 'EMPTY';\n        this.isVisible = true;\n        this.image.src = EMPTY_CELL;\n    }\n\n    generateRandomCandy () {\n        const choices = ['RED', 'ORANGE', 'BLUE', 'GREEN', 'YELLOW', 'PURPLE']\n        const exceptions = [this.previousGeneratedColor];\n\n        const newCell = new SimpleCell(selectRandomString(choices, exceptions) as Colors);\n        this.previousGeneratedColor = newCell.colorType;\n\n        return newCell;\n    }\n\n    copy :() => Cell = () => {\n        return new CandySourceCell();\n    }\n}\n","import { Cell } from \"~/models/Cells/Cell\";\nimport { Colors, COLUMNS, ROWS } from \"~/setup\";\nimport { SimpleCell } from \"~/models/Cells/SimpleCell\";\nimport { selectRandomString } from '~/utils/random';\n\nfunction compareCells (cell_1: Cell, cell_2: Cell): boolean {\n    return (cell_1.image.src == cell_2.image.src);\n}\n\nexport function generateRandomBoard (): Cell[][] {\n    const cells: Cell[][] = [];\n\n    const choices = ['RED', 'ORANGE', 'BLUE', 'GREEN', 'YELLOW', 'PURPLE']\n\n    for (let i = 0; i < ROWS; ++i) {\n        cells[i] = [];\n\n        for (let j = 0; j < COLUMNS; ++j) {\n            cells[i][j] = new SimpleCell(selectRandomString(choices) as Colors);\n        }\n    }\n\n    while (true) {\n        let didCellChange = false;\n\n        // Go through all rows and remove any elements that appear thrice in row.\n        for (let i = 0; i < ROWS; ++i) {\n            for (let j = 0; j < COLUMNS - 2; ++j) {\n                if (compareCells(cells[i][j], cells[i][j + 1]) && compareCells(cells[i][j], cells[i][j + 2])) {\n                    // Cells (i,j) (i,j+1) and (i,j+2) are in line\n                    // mark the middle cell as some different color.\n                    const exceptions = [\n                        cells[i][j + 1].colorType,\n                    ];\n    \n                    (i - 1 > -1) && exceptions.push(cells[i - 1][j + 1].colorType);\n                    (i + 1 < ROWS) && exceptions.push(cells[i + 1][j + 1].colorType);\n    \n                    cells[i][j+1] = new SimpleCell (selectRandomString(choices, exceptions) as Colors);\n\n                    didCellChange = true;\n                }\n            }\n        }\n    \n        // Go through all columns and remove elements that appear thrice in column.\n        for (let i = 0; i < COLUMNS; ++i) {\n            for (let j = 0; j < ROWS - 2; ++j) {\n                if (compareCells(cells[j][i], cells[j+1][i]) && compareCells(cells[j][i], cells[j+2][i])) {\n                    // Cells (j,i) (j+1,i) and (j+2,i) are in line\n                    // mark the middle cell as some different color.\n                    const exceptions = [\n                        cells[j + 1][i].colorType,\n                    ];\n                    \n                    (i - 1 > -1) && exceptions.push (cells[j + 1][i - 1].colorType);\n                    (i + 1 < COLUMNS) && exceptions.push (cells[j + 1][i + 1].colorType);\n    \n                    cells[j+1][i] = new SimpleCell (selectRandomString(choices, exceptions) as Colors);\n\n                    didCellChange = true;\n                }\n            }\n        }\n\n        if (!didCellChange) break;\n    }\n\n    // TODO: Remove later. Only for testing purpose only.\n    // return debug_setupMultiColored (cells);\n    // return debug_setupHard (cells, 7); // Second param can only be between 0-7\n    // return debug_setupStriped (cells, 7); // Second param can only be between 0-7\n    // return debug_gravity(cells);\n\n    return cells;\n}\n\nfunction debug_setupMultiColored(cells: Cell[][]): Cell[][] {\n    // Generate horizontal six in line.\n    cells[0][0] = new SimpleCell('BLUE');\n    cells[0][1] = new SimpleCell('BLUE');\n    cells[0][2] = new SimpleCell('GREEN');\n    cells[0][3] = new SimpleCell('BLUE');\n    cells[0][4] = new SimpleCell('BLUE');\n    cells[1][2] = new SimpleCell('BLUE');\n    cells[0][5] = new SimpleCell('GREEN');\n\n    // Generate vertical six in line.\n    cells[1][3] = new SimpleCell('RED');\n    cells[2][3] = new SimpleCell('RED');\n    cells[3][3] = new SimpleCell('ORANGE');\n    cells[4][3] = new SimpleCell('RED');\n    cells[5][3] = new SimpleCell('RED');\n    cells[3][4] = new SimpleCell('RED');\n\n    return cells;\n}\n\nfunction debug_setupHard (cells: Cell[][], idx: number): Cell[][] {\n    const blueCells: number[][][] = [\n        // Case 1. (+0, +0)\n        [\n        [1,0],     [1,2],[1,3],\n              [2,1],\n              [3,1],\n        ],\n\n        // Case 2. (+4, +0)\n        [\n              [0,1],\n        [1,0],     [1,2],\n              [2,1],\n              [3,1],\n        ],\n\n        // Case 3. (+8, +0)\n        [\n        [0,0],[0,1],     [0,3],\n                   [1,2],\n                   [2,2],\n        ],\n\n        // Case 4. (+0, +4)\n        [\n             [0,1],\n             [1,1],\n        [2,0],    [2,2],[2,3],\n        ],\n\n        // Case 5. (+4, +4)\n        [\n              [0,1],\n              [1,1],\n        [2,0],     [2,2],\n              [3,1]\n        ],\n\n        // Case 6. (+8, +4)\n        [\n                     [0,2],\n                     [1,2],\n        [2,0],[2,1],      [2,3],\n        ],\n\n        // Case 7. (+0, +0)\n        [\n             [0,1],\n        [1,0],     [1,2],[1,3],\n             [2,1],\n        ],\n\n        // Case 8. (+4, +0)\n        [\n                    [0,2],\n        [1,0],[1,1],      [1,3],\n                    [2,2],\n        ],\n    ]\n\n    const greenCells: number[][][] = [\n        // Case 1.\n        [[1,1],[1,4],[4,1]],\n        // Case 2.\n        [[1,1],[1,3],[4,1]],\n        // Case 3.\n        [[0,2],[0,4],[3,2]],\n        // Case 4.\n        [[2,1],[2,4],[3,1]],\n        // Case 5.\n        [[2,1],[2,3],[4,1]],\n        // Case 6.\n        [[2,2],[2,4],[3,2]],\n        // Case 7.\n        [[1,1],[1,4],[3,1]],\n        // Case 8.\n        [[1,2],[1,4],[3,2]]\n    ];\n\n    blueCells[idx].forEach(cell => {\n        cells[cell[0]][cell[1]] = new SimpleCell('BLUE');\n    });\n\n    greenCells[idx].forEach(cell => {\n        cells[cell[0]][cell[1]] = new SimpleCell('GREEN');\n    });\n\n    return cells;\n}\n\nfunction debug_setupStriped (cells: Cell[][], idx: number): Cell[][] {\n    const blueCells: number[][][] = [\n        // Case 1H.\n        [\n        [0,0],\n             [1,1],[1,2],[1,3],\n        ],\n        \n        // Case 2H.\n        [\n             [0,1],\n        [1,0],    [1,2],[1,3],\n        ],\n        \n        // Case 3H.\n        [\n                    [0,2],\n        [1,0],[1,1],     [1,3],\n        ],\n        \n        // Case 4H.\n        [\n                          [0,3],\n        [1,0],[1,1],[1,2],\n        ],\n        \n        // Case 1V.\n        [\n        [0,0],\n             [1,1],[2,1],[3,1],\n        ],\n        \n        // Case 2V.\n        [\n             [1,0],\n        [0,1],    [2,1],[3,1],\n        ],\n        \n        // Case 3V.\n        [\n                    [2,0],\n        [0,1],[1,1],     [3,1],\n        ],\n        \n        // Case 4V.\n        [\n                          [3,0],\n        [0,1],[1,1],[2,1],\n        ],\n    ]\n\n    const greenCells: number[][][] = [\n        // Case 1H.\n        [[1,0],[2,0],[1,4]],\n        // Case 2H.\n        [[1,1],[2,1],[1,4]],\n        // Case 3H.\n        [[1,2],[2,2],[1,4]],\n        // Case 4H.\n        [[1,3],[2,3],[1,4]],\n\n        // Case 1V.\n        [[0,1],[0,2],[4,1]],\n        // Case 2V.\n        [[1,1],[1,2],[4,1]],\n        // Case 3V.\n        [[2,1],[2,2],[4,1]],\n        // Case 4V.\n        [[3,1],[3,2],[4,1]],\n    ]\n\n    blueCells[idx].forEach(cell => {\n        cells[cell[0]][cell[1]] = new SimpleCell('BLUE');\n    });\n\n    greenCells[idx].forEach(cell => {\n        cells[cell[0]][cell[1]] = new SimpleCell('GREEN');\n    });\n\n    return cells;\n}\n\nfunction debug_gravity(cells: Cell[][]): Cell[][] {\n    const colNo = 2;\n    const rowStart = 7;\n    const rowEnd = 10;\n\n    const emptyCells: number[][] = [];\n\n    for(let i = rowStart; i <= rowEnd; ++i)\n        emptyCells.push ([i, colNo]);\n\n    emptyCells.forEach(cell => {\n        cells[cell[0]][cell[1]] = new SimpleCell('EMPTY');\n    })\n\n    return cells;\n}\n","import { CellType, Colors, COLUMNS, ROWS } from \"~/setup\";\nimport { Cell } from \"models/Cells/Cell\";\nimport { CandySourceCell } from \"./Cells/CandySourceCell\";\nimport { generateRandomBoard } from \"~/utils/boardGenerator\";\nimport { Vector } from 'setup';\nimport EMPTY_CELL_IMG from '../images/EmptyCell.png';\nimport { EventBus } from \"~/EventBus\";\n\nfunction createCandySourceCells(): CandySourceCell[] {\n    const sourceCells: CandySourceCell[] = [];\n\n    for (let i = 0; i < COLUMNS; ++i) {\n        sourceCells[i] = new CandySourceCell();\n    }\n\n    return sourceCells;\n}\n\nexport class Board {\n    // Matrix of items that represents board state.\n    cells: Cell[][];\n\n    // These cells are used for generating new candies.\n    // Instead of using an array of cells, we can just as easily use a single one,\n    // However, in the future, we might have the need to generate special candies at \n    // certain locations. An array of source cells will be useful there.\n    sourceCells: CandySourceCell[];\n\n    constructor() {\n        this.cells = generateRandomBoard();\n        this.sourceCells = createCandySourceCells();\n\n        console.log({ROWS, COLUMNS});\n        \n        this.printBoard();\n\n        EventBus.updateBoard.add (this.onBoardUpdate.bind (this));\n    }\n\n    onBoardUpdate (board: Board): void {\n        this.cells = board.cells;\n        this.sourceCells = board.sourceCells;\n\n        // EventBus.renderBoard.emit(this);\n    }\n\n    getImageAtCell (cellPos: Vector | null): HTMLImageElement {\n        const emptyCellImage = new Image();\n        emptyCellImage.src = EMPTY_CELL_IMG;\n\n        if (!cellPos) return emptyCellImage;\n\n        if (cellPos.x < 0 || cellPos.x >= ROWS || cellPos.y < 0 || cellPos.y >= COLUMNS) \n            return emptyCellImage;\n        \n        return this.cells[cellPos.x][cellPos.y].image;\n    }\n\n    getColorAtCell (cellPos: Vector | null): Colors {\n        if (!cellPos) return 'EMPTY';\n\n        if (cellPos.x < 0 || cellPos.x >= ROWS || cellPos.y < 0 || cellPos.y >= COLUMNS) \n            return 'EMPTY';\n\n        return this.cells[cellPos.x][cellPos.y].colorType;\n    }\n\n    getTypeAtCell (cellPos: Vector | null): CellType {\n        if (!cellPos) return 'NONE';\n\n        if (cellPos.x < 0 || cellPos.x >= ROWS || cellPos.y < 0 || cellPos.y >= COLUMNS) \n            return 'NONE';\n\n        return this.cells[cellPos.x][cellPos.y].cellType;\n    }\n\n    doCandiesMatch (first: Vector, second: Vector): boolean {\n        if (this.getColorAtCell(first) === this.getColorAtCell(second)) {\n            return true;\n        }\n\n        return false;\n    }\n\n    printBoard () {\n        this.cells.forEach(row => {\n            console.log(row.map(it => it.colorType[0]).toString());\n        })\n    }\n}","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","var NOW;\r\n// Include a performance.now polyfill.\r\n// In node.js, use process.hrtime.\r\n// @ts-ignore\r\nif (typeof (self) === 'undefined' && typeof (process) !== 'undefined' && process.hrtime) {\r\n    NOW = function () {\r\n        // @ts-ignore\r\n        var time = process.hrtime();\r\n        // Convert [seconds, nanoseconds] to milliseconds.\r\n        return time[0] * 1000 + time[1] / 1000000;\r\n    };\r\n}\r\n// In a browser, use self.performance.now if it is available.\r\nelse if (typeof (self) !== 'undefined' && self.performance !== undefined && self.performance.now !== undefined) {\r\n    // This must be bound, because directly assigning this function\r\n    // leads to an invocation exception in Chrome.\r\n    NOW = self.performance.now.bind(self.performance);\r\n}\r\n// Use Date.now if it is available.\r\nelse if (Date.now !== undefined) {\r\n    NOW = Date.now;\r\n}\r\n// Otherwise, use 'new Date().getTime()'.\r\nelse {\r\n    NOW = function () {\r\n        return new Date().getTime();\r\n    };\r\n}\r\nvar NOW$1 = NOW;\n\n/**\r\n * Controlling groups of tweens\r\n *\r\n * Using the TWEEN singleton to manage your tweens can cause issues in large apps with many components.\r\n * In these cases, you may want to create your own smaller groups of tween\r\n */\r\nvar Group = /** @class */ (function () {\r\n    function Group() {\r\n        this._tweens = {};\r\n        this._tweensAddedDuringUpdate = {};\r\n    }\r\n    Group.prototype.getAll = function () {\r\n        var _this = this;\r\n        return Object.keys(this._tweens).map(function (tweenId) {\r\n            return _this._tweens[tweenId];\r\n        });\r\n    };\r\n    Group.prototype.removeAll = function () {\r\n        this._tweens = {};\r\n    };\r\n    Group.prototype.add = function (tween) {\r\n        this._tweens[tween.getId()] = tween;\r\n        this._tweensAddedDuringUpdate[tween.getId()] = tween;\r\n    };\r\n    Group.prototype.remove = function (tween) {\r\n        delete this._tweens[tween.getId()];\r\n        delete this._tweensAddedDuringUpdate[tween.getId()];\r\n    };\r\n    Group.prototype.update = function (time, preserve) {\r\n        var tweenIds = Object.keys(this._tweens);\r\n        if (tweenIds.length === 0) {\r\n            return false;\r\n        }\r\n        time = time !== undefined ? time : NOW$1();\r\n        // Tweens are updated in \"batches\". If you add a new tween during an\r\n        // update, then the new tween will be updated in the next batch.\r\n        // If you remove a tween during an update, it may or may not be updated.\r\n        // However, if the removed tween was added during the current batch,\r\n        // then it will not be updated.\r\n        while (tweenIds.length > 0) {\r\n            this._tweensAddedDuringUpdate = {};\r\n            for (var i = 0; i < tweenIds.length; i++) {\r\n                var tween = this._tweens[tweenIds[i]];\r\n                if (tween && tween.update(time) === false) {\r\n                    tween.playing = false;\r\n                    if (!preserve) {\r\n                        delete this._tweens[tweenIds[i]];\r\n                    }\r\n                }\r\n            }\r\n            tweenIds = Object.keys(this._tweensAddedDuringUpdate);\r\n        }\r\n        return true;\r\n    };\r\n    return Group;\r\n}());\n\n/**\r\n * The Ease class provides a collection of easing functions for use with tween.js.\r\n */\r\nvar Easing = {\r\n    Linear: {\r\n        None: function (amount) {\r\n            return amount;\r\n        }\r\n    },\r\n    Quadratic: {\r\n        In: function (amount) {\r\n            return amount * amount;\r\n        },\r\n        Out: function (amount) {\r\n            return amount * (2 - amount);\r\n        },\r\n        InOut: function (amount) {\r\n            if ((amount *= 2) < 1) {\r\n                return 0.5 * amount * amount;\r\n            }\r\n            return -0.5 * (--amount * (amount - 2) - 1);\r\n        }\r\n    },\r\n    Cubic: {\r\n        In: function (amount) {\r\n            return amount * amount * amount;\r\n        },\r\n        Out: function (amount) {\r\n            return --amount * amount * amount + 1;\r\n        },\r\n        InOut: function (amount) {\r\n            if ((amount *= 2) < 1) {\r\n                return 0.5 * amount * amount * amount;\r\n            }\r\n            return 0.5 * ((amount -= 2) * amount * amount + 2);\r\n        }\r\n    },\r\n    Quartic: {\r\n        In: function (amount) {\r\n            return amount * amount * amount * amount;\r\n        },\r\n        Out: function (amount) {\r\n            return 1 - (--amount * amount * amount * amount);\r\n        },\r\n        InOut: function (amount) {\r\n            if ((amount *= 2) < 1) {\r\n                return 0.5 * amount * amount * amount * amount;\r\n            }\r\n            return -0.5 * ((amount -= 2) * amount * amount * amount - 2);\r\n        }\r\n    },\r\n    Quintic: {\r\n        In: function (amount) {\r\n            return amount * amount * amount * amount * amount;\r\n        },\r\n        Out: function (amount) {\r\n            return --amount * amount * amount * amount * amount + 1;\r\n        },\r\n        InOut: function (amount) {\r\n            if ((amount *= 2) < 1) {\r\n                return 0.5 * amount * amount * amount * amount * amount;\r\n            }\r\n            return 0.5 * ((amount -= 2) * amount * amount * amount * amount + 2);\r\n        }\r\n    },\r\n    Sinusoidal: {\r\n        In: function (amount) {\r\n            return 1 - Math.cos(amount * Math.PI / 2);\r\n        },\r\n        Out: function (amount) {\r\n            return Math.sin(amount * Math.PI / 2);\r\n        },\r\n        InOut: function (amount) {\r\n            return 0.5 * (1 - Math.cos(Math.PI * amount));\r\n        }\r\n    },\r\n    Exponential: {\r\n        In: function (amount) {\r\n            return amount === 0 ? 0 : Math.pow(1024, amount - 1);\r\n        },\r\n        Out: function (amount) {\r\n            return amount === 1 ? 1 : 1 - Math.pow(2, -10 * amount);\r\n        },\r\n        InOut: function (amount) {\r\n            if (amount === 0) {\r\n                return 0;\r\n            }\r\n            if (amount === 1) {\r\n                return 1;\r\n            }\r\n            if ((amount *= 2) < 1) {\r\n                return 0.5 * Math.pow(1024, amount - 1);\r\n            }\r\n            return 0.5 * (-Math.pow(2, -10 * (amount - 1)) + 2);\r\n        }\r\n    },\r\n    Circular: {\r\n        In: function (amount) {\r\n            return 1 - Math.sqrt(1 - amount * amount);\r\n        },\r\n        Out: function (amount) {\r\n            return Math.sqrt(1 - (--amount * amount));\r\n        },\r\n        InOut: function (amount) {\r\n            if ((amount *= 2) < 1) {\r\n                return -0.5 * (Math.sqrt(1 - amount * amount) - 1);\r\n            }\r\n            return 0.5 * (Math.sqrt(1 - (amount -= 2) * amount) + 1);\r\n        }\r\n    },\r\n    Elastic: {\r\n        In: function (amount) {\r\n            if (amount === 0) {\r\n                return 0;\r\n            }\r\n            if (amount === 1) {\r\n                return 1;\r\n            }\r\n            return -Math.pow(2, 10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI);\r\n        },\r\n        Out: function (amount) {\r\n            if (amount === 0) {\r\n                return 0;\r\n            }\r\n            if (amount === 1) {\r\n                return 1;\r\n            }\r\n            return Math.pow(2, -10 * amount) * Math.sin((amount - 0.1) * 5 * Math.PI) + 1;\r\n        },\r\n        InOut: function (amount) {\r\n            if (amount === 0) {\r\n                return 0;\r\n            }\r\n            if (amount === 1) {\r\n                return 1;\r\n            }\r\n            amount *= 2;\r\n            if (amount < 1) {\r\n                return -0.5 * Math.pow(2, 10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI);\r\n            }\r\n            return 0.5 * Math.pow(2, -10 * (amount - 1)) * Math.sin((amount - 1.1) * 5 * Math.PI) + 1;\r\n        }\r\n    },\r\n    Back: {\r\n        In: function (amount) {\r\n            var s = 1.70158;\r\n            return amount * amount * ((s + 1) * amount - s);\r\n        },\r\n        Out: function (amount) {\r\n            var s = 1.70158;\r\n            return --amount * amount * ((s + 1) * amount + s) + 1;\r\n        },\r\n        InOut: function (amount) {\r\n            var s = 1.70158 * 1.525;\r\n            if ((amount *= 2) < 1) {\r\n                return 0.5 * (amount * amount * ((s + 1) * amount - s));\r\n            }\r\n            return 0.5 * ((amount -= 2) * amount * ((s + 1) * amount + s) + 2);\r\n        }\r\n    },\r\n    Bounce: {\r\n        In: function (amount) {\r\n            return 1 - Easing.Bounce.Out(1 - amount);\r\n        },\r\n        Out: function (amount) {\r\n            if (amount < (1 / 2.75)) {\r\n                return 7.5625 * amount * amount;\r\n            }\r\n            else if (amount < (2 / 2.75)) {\r\n                return 7.5625 * (amount -= (1.5 / 2.75)) * amount + 0.75;\r\n            }\r\n            else if (amount < (2.5 / 2.75)) {\r\n                return 7.5625 * (amount -= (2.25 / 2.75)) * amount + 0.9375;\r\n            }\r\n            else {\r\n                return 7.5625 * (amount -= (2.625 / 2.75)) * amount + 0.984375;\r\n            }\r\n        },\r\n        InOut: function (amount) {\r\n            if (amount < 0.5) {\r\n                return Easing.Bounce.In(amount * 2) * 0.5;\r\n            }\r\n            return Easing.Bounce.Out(amount * 2 - 1) * 0.5 + 0.5;\r\n        }\r\n    }\r\n};\n\n/**\r\n *\r\n */\r\nvar Interpolation = {\r\n    Linear: function (v, k) {\r\n        var m = v.length - 1;\r\n        var f = m * k;\r\n        var i = Math.floor(f);\r\n        var fn = Interpolation.Utils.Linear;\r\n        if (k < 0) {\r\n            return fn(v[0], v[1], f);\r\n        }\r\n        if (k > 1) {\r\n            return fn(v[m], v[m - 1], m - f);\r\n        }\r\n        return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\r\n    },\r\n    Bezier: function (v, k) {\r\n        var b = 0;\r\n        var n = v.length - 1;\r\n        var pw = Math.pow;\r\n        var bn = Interpolation.Utils.Bernstein;\r\n        for (var i = 0; i <= n; i++) {\r\n            b += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);\r\n        }\r\n        return b;\r\n    },\r\n    CatmullRom: function (v, k) {\r\n        var m = v.length - 1;\r\n        var f = m * k;\r\n        var i = Math.floor(f);\r\n        var fn = Interpolation.Utils.CatmullRom;\r\n        if (v[0] === v[m]) {\r\n            if (k < 0) {\r\n                i = Math.floor(f = m * (1 + k));\r\n            }\r\n            return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\r\n        }\r\n        else {\r\n            if (k < 0) {\r\n                return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\r\n            }\r\n            if (k > 1) {\r\n                return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\r\n            }\r\n            return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\r\n        }\r\n    },\r\n    Utils: {\r\n        Linear: function (p0, p1, t) {\r\n            return (p1 - p0) * t + p0;\r\n        },\r\n        Bernstein: function (n, i) {\r\n            var fc = Interpolation.Utils.Factorial;\r\n            return fc(n) / fc(i) / fc(n - i);\r\n        },\r\n        Factorial: (function () {\r\n            var a = [1];\r\n            return function (n) {\r\n                var s = 1;\r\n                if (a[n]) {\r\n                    return a[n];\r\n                }\r\n                for (var i = n; i > 1; i--) {\r\n                    s *= i;\r\n                }\r\n                a[n] = s;\r\n                return s;\r\n            };\r\n        })(),\r\n        CatmullRom: function (p0, p1, p2, p3, t) {\r\n            var v0 = (p2 - p0) * 0.5;\r\n            var v1 = (p3 - p1) * 0.5;\r\n            var t2 = t * t;\r\n            var t3 = t * t2;\r\n            return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n        }\r\n    }\r\n};\n\n/**\r\n * Utils\r\n */\r\nvar Sequence = /** @class */ (function () {\r\n    function Sequence() {\r\n    }\r\n    Sequence._nextId = 0;\r\n    Sequence.nextId = function () {\r\n        return Sequence._nextId++;\r\n    };\r\n    return Sequence;\r\n}());\n\n/**\r\n * Tween.js - Licensed under the MIT license\r\n * https://github.com/tweenjs/tween.js\r\n * ----------------------------------------------\r\n *\r\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\r\n * Thank you all, you're awesome!\r\n */\r\n/**\r\n * A tween (from in-between) is a concept that allows you to change the values of the properties of an object in a\r\n * smooth way. You just tell it which properties you want to change, which final values should they have when the\r\n * tween finishes running, and how long should this take, and the tweening engine will take care of finding the\r\n * intermediate values from the starting to the ending point.\r\n */\r\nvar Tween = /** @class */ (function () {\r\n    function Tween(object, groupRef) {\r\n        this.playing = false;\r\n        this.paused = false;\r\n        this.pauseStart = 0;\r\n        this.valuesStart = {};\r\n        this.valuesEnd = {};\r\n        this.valuesStartRepeat = {};\r\n        this.durationValue = 1000;\r\n        this.repeatValue = 0;\r\n        this.yoyoValue = false;\r\n        this.reversed = false;\r\n        this.delayTime = 0;\r\n        this.startTime = 0;\r\n        this.easingFunction = Easing.Linear.None;\r\n        this.interpolationFunction = Interpolation.Linear;\r\n        this.chainedTweens = [];\r\n        this.onStartCallbackFired = false;\r\n        this.id = Sequence.nextId();\r\n        this.object = object;\r\n        this.groupRef = groupRef || Tween.TWEEN;\r\n    }\r\n    Tween.inject = function (instance) {\r\n        Tween.TWEEN = instance;\r\n    };\r\n    Tween.prototype.getId = function () {\r\n        return this.id;\r\n    };\r\n    Tween.prototype.isPlaying = function () {\r\n        return this.playing;\r\n    };\r\n    Tween.prototype.isPaused = function () {\r\n        return this.paused;\r\n    };\r\n    Tween.prototype.to = function (properties, duration) {\r\n        this.valuesEnd = Object.create(properties);\r\n        if (duration !== undefined) {\r\n            this.durationValue = duration;\r\n        }\r\n        return this;\r\n    };\r\n    Tween.prototype.duration = function (value) {\r\n        this.durationValue = value;\r\n        return this;\r\n    };\r\n    Tween.prototype.start = function (time) {\r\n        this.groupRef.add(this);\r\n        this.playing = true;\r\n        this.paused = false;\r\n        this.onStartCallbackFired = false;\r\n        this.startTime = time !== undefined\r\n            ? (typeof time === 'string'\r\n                ? NOW$1() + parseFloat(time)\r\n                : time)\r\n            : NOW$1();\r\n        this.startTime += this.delayTime;\r\n        for (var property in this.valuesEnd) {\r\n            // Check if an Array was provided as property value\r\n            if (this.valuesEnd[property] instanceof Array) {\r\n                if (this.valuesEnd[property].length === 0) {\r\n                    continue;\r\n                }\r\n                // Create a local copy of the Array with the start value at the front\r\n                this.valuesEnd[property] = [this.object[property]].concat(this.valuesEnd[property]);\r\n            }\r\n            // If `to()` specifies a property that doesn't exist in the source object,\r\n            // we should not set that property in the object\r\n            if (this.object[property] === undefined) {\r\n                continue;\r\n            }\r\n            // Save the starting value, but only once.\r\n            if (typeof (this.valuesStart[property]) === 'undefined') {\r\n                this.valuesStart[property] = this.object[property];\r\n            }\r\n            if ((this.valuesStart[property] instanceof Array) === false) {\r\n                this.valuesStart[property] *= 1.0; // Ensures we're using numbers, not strings\r\n            }\r\n            this.valuesStartRepeat[property] = this.valuesStart[property] || 0;\r\n        }\r\n        return this;\r\n    };\r\n    Tween.prototype.stop = function () {\r\n        if (!this.playing) {\r\n            return this;\r\n        }\r\n        this.groupRef.remove(this);\r\n        this.playing = false;\r\n        this.paused = false;\r\n        if (this.onStopCallback) {\r\n            this.onStopCallback(this.object);\r\n        }\r\n        this.stopChainedTweens();\r\n        return this;\r\n    };\r\n    Tween.prototype.end = function () {\r\n        this.update(Infinity);\r\n        return this;\r\n    };\r\n    Tween.prototype.pause = function (time) {\r\n        if (this.paused || !this.playing) {\r\n            return this;\r\n        }\r\n        this.paused = true;\r\n        this.pauseStart = time === undefined ? NOW$1() : time;\r\n        this.groupRef.remove(this);\r\n        return this;\r\n    };\r\n    Tween.prototype.resume = function (time) {\r\n        if (!this.paused || !this.playing) {\r\n            return this;\r\n        }\r\n        this.paused = false;\r\n        this.startTime += (time === undefined ? NOW$1() : time) - this.pauseStart;\r\n        this.pauseStart = 0;\r\n        this.groupRef.add(this);\r\n        return this;\r\n    };\r\n    Tween.prototype.stopChainedTweens = function () {\r\n        for (var i = 0, numChainedTweens = this.chainedTweens.length; i < numChainedTweens; i++) {\r\n            this.chainedTweens[i].stop();\r\n        }\r\n    };\r\n    Tween.prototype.group = function (group) {\r\n        this.groupRef = group;\r\n        return this;\r\n    };\r\n    Tween.prototype.delay = function (amount) {\r\n        this.delayTime = amount;\r\n        return this;\r\n    };\r\n    Tween.prototype.repeat = function (times) {\r\n        this.repeatValue = times;\r\n        return this;\r\n    };\r\n    Tween.prototype.repeatDelay = function (amount) {\r\n        this.repeatDelayTime = amount;\r\n        return this;\r\n    };\r\n    Tween.prototype.yoyo = function (yoyo) {\r\n        this.yoyoValue = yoyo;\r\n        return this;\r\n    };\r\n    Tween.prototype.easing = function (easing) {\r\n        this.easingFunction = easing;\r\n        return this;\r\n    };\r\n    Tween.prototype.interpolation = function (interpolation) {\r\n        this.interpolationFunction = interpolation;\r\n        return this;\r\n    };\r\n    Tween.prototype.chain = function () {\r\n        var tweens = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            tweens[_i] = arguments[_i];\r\n        }\r\n        this.chainedTweens = tweens;\r\n        return this;\r\n    };\r\n    Tween.prototype.onStart = function (callback) {\r\n        this.onStartCallback = callback;\r\n        return this;\r\n    };\r\n    Tween.prototype.onUpdate = function (callback) {\r\n        this.onUpdateCallback = callback;\r\n        return this;\r\n    };\r\n    Tween.prototype.onRepeat = function (callback) {\r\n        this.onRepeatCallback = callback;\r\n        return this;\r\n    };\r\n    Tween.prototype.onComplete = function (callback) {\r\n        this.onCompleteCallback = callback;\r\n        return this;\r\n    };\r\n    Tween.prototype.onStop = function (callback) {\r\n        this.onStopCallback = callback;\r\n        return this;\r\n    };\r\n    /**\r\n     * Tween.js doesn't run by itself. You need to tell it when to run, by explicitly calling the update method.\r\n     * The recommended method is to do this inside your main animation loop, which should be called with\r\n     * requestAnimationFrame for getting the best graphics performance\r\n     *\r\n     * If called without parameters, update will determine the current time in order to find out how long has it been\r\n     * since the last time it ran.\r\n     *\r\n     * @param time\r\n     */\r\n    Tween.prototype.update = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        var property;\r\n        var elapsed;\r\n        var value;\r\n        if (time < this.startTime) {\r\n            return true;\r\n        }\r\n        if (this.onStartCallbackFired === false) {\r\n            if (this.onStartCallback) {\r\n                this.onStartCallback(this.object);\r\n            }\r\n            this.onStartCallbackFired = true;\r\n        }\r\n        elapsed = (time - this.startTime) / this.durationValue;\r\n        elapsed = (this.durationValue === 0 || elapsed > 1) ? 1 : elapsed;\r\n        value = this.easingFunction(elapsed);\r\n        for (property in this.valuesEnd) {\r\n            // Don't update properties that do not exist in the source object\r\n            if (this.valuesStart[property] === undefined) {\r\n                continue;\r\n            }\r\n            var start = this.valuesStart[property] || 0;\r\n            var end = this.valuesEnd[property];\r\n            if (end instanceof Array) {\r\n                this.object[property] = this.interpolationFunction(end, value);\r\n            }\r\n            else {\r\n                // Parses relative end values with start as base (e.g.: +10, -3)\r\n                if (typeof (end) === 'string') {\r\n                    if (end.charAt(0) === '+' || end.charAt(0) === '-') {\r\n                        end = start + parseFloat(end);\r\n                    }\r\n                    else {\r\n                        end = parseFloat(end);\r\n                    }\r\n                }\r\n                // Protect against non numeric properties.\r\n                if (typeof (end) === 'number') {\r\n                    this.object[property] = start + (end - start) * value;\r\n                }\r\n            }\r\n        }\r\n        if (this.onUpdateCallback) {\r\n            this.onUpdateCallback(this.object, elapsed);\r\n        }\r\n        if (elapsed === 1) {\r\n            if (this.repeatValue > 0) {\r\n                if (isFinite(this.repeatValue)) {\r\n                    this.repeatValue--;\r\n                }\r\n                // Reassign starting values, restart by making startTime = now\r\n                for (property in this.valuesStartRepeat) {\r\n                    if (typeof (this.valuesEnd[property]) === 'string') {\r\n                        this.valuesStartRepeat[property] = this.valuesStartRepeat[property] + parseFloat(this.valuesEnd[property]);\r\n                    }\r\n                    if (this.yoyoValue) {\r\n                        var tmp = this.valuesStartRepeat[property];\r\n                        this.valuesStartRepeat[property] = this.valuesEnd[property];\r\n                        this.valuesEnd[property] = tmp;\r\n                    }\r\n                    this.valuesStart[property] = this.valuesStartRepeat[property];\r\n                }\r\n                if (this.yoyoValue) {\r\n                    this.reversed = !this.reversed;\r\n                }\r\n                if (this.repeatDelayTime !== undefined) {\r\n                    this.startTime = time + this.repeatDelayTime;\r\n                }\r\n                else {\r\n                    this.startTime = time + this.delayTime;\r\n                }\r\n                if (this.onRepeatCallback) {\r\n                    this.onRepeatCallback(this.object);\r\n                }\r\n                return true;\r\n            }\r\n            else {\r\n                if (this.onCompleteCallback) {\r\n                    this.onCompleteCallback(this.object);\r\n                }\r\n                for (var i = 0, numChainedTweens = this.chainedTweens.length; i < numChainedTweens; i++) {\r\n                    // Make the chained tweens start exactly at the time they should,\r\n                    // even if the `update()` method was called way past the duration of the tween\r\n                    this.chainedTweens[i].start(this.startTime + this.durationValue);\r\n                }\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    return Tween;\r\n}());\n\nvar VERSION = '18.6.0';\n\n/**\r\n * Tween.js - Licensed under the MIT license\r\n * https://github.com/tweenjs/tween.js\r\n * ----------------------------------------------\r\n *\r\n * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.\r\n * Thank you all, you're awesome!\r\n */\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\n/**\r\n * Controlling groups of tweens\r\n *\r\n * Using the TWEEN singleton to manage your tweens can cause issues in large apps with many components.\r\n * In these cases, you may want to create your own smaller groups of tween\r\n */\r\nvar Main = /** @class */ (function (_super) {\r\n    __extends(Main, _super);\r\n    function Main() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.version = VERSION;\r\n        _this.now = NOW$1;\r\n        _this.Group = Group;\r\n        _this.Easing = Easing;\r\n        _this.Interpolation = Interpolation;\r\n        _this.nextId = Sequence.nextId;\r\n        _this.Tween = Tween;\r\n        return _this;\r\n    }\r\n    return Main;\r\n}(Group));\r\nvar TWEEN = new Main();\r\nTween.inject(TWEEN);\n\nexport default TWEEN;\n","import { EventBus } from \"~/EventBus\";\nimport { ANIMATION_DURATION, CellPos, Vector } from \"~/setup\";\nimport { CELL_WIDTH, CELL_PADDING, CELL_HEIGHT } from \"~/setup\";\nimport TWEEN from \"tween.ts\"\n\nfunction drawCellAtPos (context: CanvasRenderingContext2D | null, x: number, y: number, img: HTMLImageElement): void {\n    const width = CELL_WIDTH + 2 * CELL_PADDING;\n    const height = CELL_HEIGHT + 2 * CELL_PADDING;\n\n    context?.clearRect(x + 5, y, width - 5, height - 5);\n    context?.drawImage(\n        img, \n        x, \n        y, \n        width,\n        height\n    );\n}\n\ntype GravityData = {\n    images: HTMLImageElement[],\n    startPoint: Vector,\n}\n\nexport class GravityAnimationView {\n    // Context for rendering.\n    private context: CanvasRenderingContext2D | null;\n    \n    // For tween animations.\n    private tweenValue = {x: 0, y: 0};\n    private tween = new TWEEN.Tween(this.tweenValue);\n    private tweenDone: boolean = true;\n\n    // List of all cells modified.\n    private cellsMoved: GravityData = {images: [], startPoint: {x: 0, y: 0}};\n\n    constructor (context: CanvasRenderingContext2D | null) {\n        this.context = context;\n\n        EventBus.renderGravityAnimation.add (this.drawGravityAnimation.bind (this));\n    }\n\n    drawGravityAnimation (cells: GravityData) {\n\n        this.context?.resetTransform();\n        this.context?.translate(CELL_PADDING, CELL_PADDING);\n\n        this.cellsMoved = cells;\n\n        this.tweenValue = {\n            x: 0, \n            y: 0,\n        };\n\n        const endValue = {\n            x: 0,\n            y: cells.images.length - cells.startPoint.x\n        };\n\n        this.tween = new TWEEN.Tween (this.tweenValue)\n            .to (endValue, ANIMATION_DURATION)\n            .easing (TWEEN.Easing.Linear.None)\n            .onComplete(this.setTweenDone.bind(this))\n            .start();\n        this.tweenDone = false;\n        \n\n        requestAnimationFrame(this.animateGravity.bind(this));\n    }\n\n    setTweenDone() {\n        this.tweenDone = true;\n    }\n\n    animateGravity(timeStamp: number) {\n        TWEEN.update(timeStamp);\n        \n        this.cellsMoved.images.forEach((img, idx) => {\n            drawCellAtPos(\n                this.context,\n                this.cellsMoved.startPoint.y * (CELL_WIDTH + CELL_PADDING),\n                (this.tweenValue.y - idx + this.cellsMoved.startPoint.x - 1) * (CELL_HEIGHT + CELL_PADDING ),// + this.cellsMoved.startPoint.y,\n                img\n            )\n        })\n        \n\n        if (!this.tweenDone)\n            requestAnimationFrame(this.animateGravity.bind(this));\n    }\n}\n","import { EventBus } from \"~/EventBus\";\nimport { MOVES } from \"~/setup\";\n\nexport class ScoreView {\n    private scoreElement: HTMLDivElement;\n    private movesElement: HTMLDivElement;\n    private score: number = 0;\n    private moves: number = MOVES;\n\n    constructor(scorePanel: string, movesPanel: string) {\n        this.scoreElement = document.getElementById(scorePanel) as HTMLDivElement;\n        this.movesElement = document.getElementById(movesPanel) as HTMLDivElement;\n\n        this.printScoreAndMoves();\n\n        EventBus.incrementScore.add (this.handleScoreInc.bind(this));\n        EventBus.decrementMoves.add (this.handleMoves.bind(this));\n        EventBus.gameOver.add (this.handleGameOver.bind(this));\n    }\n\n    handleScoreInc (newScore: number) {\n        this.score += newScore;\n        this.printScoreAndMoves();\n    }\n\n    handleMoves () {\n        this.moves -= 1;\n\n        if (this.moves < 1) {\n            EventBus.gameOver.emit ();\n        } else {\n            this.printScoreAndMoves();\n        }\n    }\n\n    printScoreAndMoves () {\n        this.scoreElement.innerText = `Score: ${this.score}`;\n        this.movesElement.innerText = `Moves: ${this.moves}`;\n    }\n\n    handleGameOver () {\n        this.scoreElement.innerText = `Game Over. You Scored ${this.score}`;\n        this.movesElement.innerText = '';\n    }\n}","import { EventBus } from \"~/EventBus\";\nimport { CellPos, Vector } from \"~/setup\";\nimport { CELL_WIDTH, CELL_PADDING, CELL_HEIGHT } from \"~/setup\";\nimport TWEEN from \"tween.ts\"\n\nfunction drawCellAtPos (context: CanvasRenderingContext2D | null, x: number, y: number, img: HTMLImageElement): void {\n    const width = CELL_WIDTH + 2 * CELL_PADDING;\n    const height = CELL_HEIGHT + 2 * CELL_PADDING;\n\n    context?.drawImage(\n        img, \n        x, \n        y, \n        width,\n        height\n    );\n}\n\nexport class SwapAnimationView {\n    // Context for rendering.\n    private context: CanvasRenderingContext2D | null;\n    \n    // For tween animations.\n    private tweenValue = {x: 0, y: 0};\n    private initialPos: {first: Vector, second: Vector} = {first: {x:0,y:0}, second: {x:0,y:0}};\n    private tween = new TWEEN.Tween(this.tweenValue);\n\n    // For images to render.\n    private images: {first: HTMLImageElement, second: HTMLImageElement};\n\n    constructor (context: CanvasRenderingContext2D | null) {\n        this.context = context;\n        this.images = {first: new Image(), second: new Image()};\n\n        EventBus.renderSwapAnimation.add (this.drawSwapAnimation.bind (this));\n    }\n\n    drawSwapAnimation (params: {first: CellPos, second: CellPos}) {\n        const {first, second} = params;\n\n        this.context?.resetTransform();\n        this.context?.translate(CELL_PADDING, CELL_PADDING);\n\n        this.images = {\n            first: first.img,\n            second: second.img\n        }\n\n        this.initialPos = {\n            first: {x: first.pos.x * (CELL_PADDING + CELL_WIDTH), y: first.pos.y * (CELL_PADDING + CELL_HEIGHT)},\n            second: {x: second.pos.x * (CELL_PADDING + CELL_WIDTH), y: second.pos.y * (CELL_PADDING + CELL_HEIGHT)},\n        };\n\n        const endValue = {\n            x: first.pos.x === second.pos.x ? 0 : 1,\n            y: first.pos.y === second.pos.y ? 0 : 1,\n        }\n\n        this.tween = new TWEEN.Tween (this.tweenValue)\n            .to (endValue, 500)\n            .easing (TWEEN.Easing.Quadratic.InOut)\n            .start();\n\n        requestAnimationFrame(this.animateSwap.bind(this));\n    }\n\n    animateSwap(timeStamp: number) {\n        TWEEN.update(timeStamp);\n\n        const fx = this.tweenValue.x * (this.initialPos.second.x - this.initialPos.first.x) + this.initialPos.first.x;\n        const fy = this.tweenValue.y * (this.initialPos.second.y - this.initialPos.first.y) + this.initialPos.first.y;\n\n        const sx = this.tweenValue.x * (this.initialPos.first.x - this.initialPos.second.x) + this.initialPos.second.x;\n        const sy = this.tweenValue.y * (this.initialPos.first.y - this.initialPos.second.y) + this.initialPos.second.y;\n        \n        const rectX = Math.min(this.initialPos.first.y, this.initialPos.second.y);\n        const rectY = Math.min(this.initialPos.first.x, this.initialPos.second.x);\n        const rectW = Math.abs(this.initialPos.first.y - this.initialPos.second.y) + CELL_HEIGHT + CELL_PADDING + 5;\n        const rectH = Math.abs(this.initialPos.first.x - this.initialPos.second.x) + CELL_WIDTH + CELL_PADDING + 5;\n        this.context?.clearRect(rectX, rectY, rectW, rectH);\n        \n        // Draw first cell.\n        drawCellAtPos (\n            this.context,\n            fy,\n            fx,\n            this.images.first\n        );\n\n        // // Draw second cell.\n        drawCellAtPos (\n            this.context,\n            sy,\n            sx,\n            this.images.second\n        );\n\n        // Break the animation if tweening is done.\n        if (this.tweenValue.x == 1 || this.tweenValue.y == 1) {\n            this.tweenValue = {x: 0, y: 0};\n            return;\n        }\n\n        requestAnimationFrame(this.animateSwap.bind(this));\n    }\n}","import { EventBus } from \"~/EventBus\";\nimport { Board } from \"~/models/Board\";\nimport { BOARD_HEIGHT, BOARD_WIDTH, CELL_HEIGHT, CELL_PADDING, CELL_WIDTH, COLUMNS, ROWS } from \"~/setup\";\nimport { GravityAnimationView } from \"./GravityAnimationView\";\nimport { ScoreView } from \"./ScoreView\";\nimport { SwapAnimationView } from \"./SwapAnimationView\";\n\nexport class CanvasView {\n    canvas: HTMLCanvasElement;\n    private context: CanvasRenderingContext2D | null;\n\n    private swapAnimation: SwapAnimationView;\n    private gravityAnimation: GravityAnimationView;\n    private scoreView: ScoreView;\n\n    constructor(canvasName: string) {\n        this.canvas = document.getElementById(canvasName) as HTMLCanvasElement;\n        this.canvas.width = BOARD_WIDTH;\n        this.canvas.height = BOARD_HEIGHT;\n        this.context = this.canvas.getContext('2d');\n\n        this.swapAnimation = new SwapAnimationView(this.context);\n        this.gravityAnimation = new GravityAnimationView(this.context);\n        this.scoreView = new ScoreView(\"scoreContainer\", \"movesContainer\");\n\n        EventBus.renderBoard.add(this.drawBoard.bind(this));\n    }\n\n    clearCanvas() {\n        this.context?.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    drawBoard(board: Board) {\n        this.context?.resetTransform();\n        this.context?.translate(CELL_PADDING, CELL_PADDING);\n        this.clearCanvas();\n\n        // Draw all the cells.\n        for(let i = 0; i < COLUMNS; ++i) {\n            for (let j = 0; j < ROWS; ++j) {\n                \n                const x = (CELL_PADDING + CELL_WIDTH) * i;\n                const y = (CELL_PADDING + CELL_HEIGHT) * j;\n\n                this.context?.drawImage(\n                    board.getImageAtCell({x: j, y: i}), \n                    x, \n                    y, \n                    CELL_WIDTH + 2 * CELL_PADDING, \n                    CELL_HEIGHT + 2 * CELL_PADDING\n                );                \n            }\n        }\n    }\n\n    cellClicked (pos_x: number, pos_y: number) {\n        this.context?.beginPath();\n        this.context?.rect(\n            CELL_PADDING + pos_x * (CELL_PADDING + CELL_WIDTH),\n            CELL_PADDING + pos_y * (CELL_PADDING + CELL_HEIGHT),\n            CELL_WIDTH,\n            CELL_HEIGHT\n        );\n        this.context?.fill();\n        console.log(\"Clicked \", pos_x, pos_y);\n    }\n}","import { EventBus } from \"~/EventBus\";\nimport { ANIMATION_DURATION, COLUMNS, delay, ROWS, Scores, Vector } from \"~/setup\";\nimport { Board } from \"~/models/Board\";\nimport { SimpleCell } from \"~/models/Cells/SimpleCell\";\n\nexport class CandyDestroyer {\n    constructor() {\n        EventBus.destroyCandies.add (this.handleDestroyCandies.bind(this));\n    }\n\n    async handleDestroyCandies(params: {board: Board, candies: Vector[]}) {\n        let board = params.board;\n        const candies = params.candies;\n        \n        candies.forEach(candy => {\n            board = this.destroyCandyUsingType(board, candy);\n        });\n\n        // Update the global board object.\n        EventBus.updateBoard.emit (board);\n        // Redraw the canvas.\n        EventBus.renderBoard.emit (board);\n        await delay(ANIMATION_DURATION / 2);\n\n        // Apply gravity to board.\n        EventBus.applyGravity.emit ();\n    }\n\n    // Destroy candy using type of candy and return new board.\n    destroyCandyUsingType(board: Board, pos: Vector): Board {\n        switch (board.getTypeAtCell(pos)) {\n            case 'SIMPLE': \n                // For simple, just replace the given candy with empty candy.\n                board.cells[pos.x][pos.y] = new SimpleCell('EMPTY');\n                EventBus.incrementScore.emit(Scores.SIMPLE);\n                break;\n            case 'HARD':\n                // For hard candy, destroy all in 3x3 area.\n                board.cells[pos.x][pos.y] = new SimpleCell('EMPTY');\n                for (let i = -1; i < 2; ++i) {\n                    for (let j = -1; j < 2; ++j) {\n                        // board.cells[pos.x + i][pos.y + j] = new SimpleCell('EMPTY');\n                        if (i === 0 && j === 0) continue;\n                        board = this.destroyCandyUsingType(board, {x: pos.x + i, y: pos.y + j});\n                    }\n                }\n                EventBus.incrementScore.emit(Scores.HARD);\n                break;\n            case 'STRIPED_H':\n                // for horizontal striped, destroy a horizontal strip.\n                for (let i = 0; i < COLUMNS; ++i) {\n                    board.cells[pos.x][i] = new SimpleCell('EMPTY');\n                }\n                EventBus.incrementScore.emit(Scores.STRIPED_H);\n                break;\n            case 'STRIPED_V':\n                // for vertical striped, destroy a vertical strip.\n                for (let i = 0; i < ROWS; ++i) {\n                    board.cells[i][pos.y] = new SimpleCell('EMPTY');\n                }\n                EventBus.incrementScore.emit(Scores.STRIPED_V);\n                break;\n            case 'MULTICOLORED':\n                board.cells[pos.x][pos.y] = new SimpleCell('EMPTY');\n                EventBus.incrementScore.emit(Scores.MULTICOLORED);\n                break;\n            default: break;\n        }\n\n        return board;\n    }\n}","import { Board } from 'models/Board';\nimport { EventBus } from '~/EventBus';\nimport { SimpleCell } from '~/models/Cells/SimpleCell';\nimport { COLUMNS, delay, ROWS, Vector } from '~/setup';\n\n// After some candies are destroyed, this class will cause candies to move down.\nexport class GravityHandler {\n    private board: Board;\n\n    constructor(board: Board) {\n        this.board = board;\n\n        EventBus.applyGravity.add (this.applyGravityToBoard.bind (this));\n        EventBus.updateBoard.add (this.handleAddBoard.bind (this));\n    }\n\n    handleAddBoard (board: Board) {\n        this.board = board;\n    }\n\n    async applyGravityToBoard () {\n\n        while(true) {\n            let cellsModified = false;\n\n            // Fill all empty cells.\n            for (let i = 0; i < ROWS - 1; ++i) {\n                for (let j = 0; j < COLUMNS; ++j) {\n                    if (this.board.getColorAtCell({x: i + 1, y: j}) == 'EMPTY') {\n                        this.board.cells[i+1][j] = this.board.cells[i][j];\n                        this.board.cells[i][j] = new SimpleCell('EMPTY');\n\n                        cellsModified = true;\n                    }\n                }\n            }\n            \n            // Fill first row using source cells.\n            for (let i = 0; i < COLUMNS; ++i) {\n                if (this.board.getColorAtCell({x: 0, y: i}) == 'EMPTY') {\n                    this.board.cells[0][i] = this.board.sourceCells[i].generateRandomCandy();\n                }\n            }\n\n            if (cellsModified === false) {\n                if (checkBoardPostGravity(this.board)) {\n                    EventBus.destroyCandyMatches.emit(this.board);\n                } else {\n                    break;\n                }\n            }\n\n            EventBus.renderBoard.emit (this.board);\n            await delay(150);\n        }\n\n        // Check board for matching candies.\n        EventBus.destroyCandyMatches.emit(this.board);\n\n        // Update the board and re-render.\n        EventBus.updateBoard.emit (this.board);\n\n        // Render the board.\n        EventBus.renderBoard.emit (this.board);\n\n    }\n\n}\n\nfunction checkBoardPostGravity(board: Board) {\n    // Loops through all cells to check if they match.\n    for (let i = 0; i < ROWS; ++i) {\n        for (let j = 0; j < COLUMNS; ++j) {\n            if (checkIfCandiesMatch(board, {x: i, y: j})) {\n                return true;\n            }\n        }\n    }\n\n    return false;\n}\n\nfunction checkIfCandiesMatch (board: Board, cellPos: Vector): boolean {\n    /*\n                      ( top2 )\n                      ( top1 )\n      (left2) (left1) (cellPos) (right1) (right2)\n                      (bottom1)\n                      (bottom2)\n     */\n    // cellPos = {x: cellPos.y, y: cellPos.x};\n    const top1 = {x: cellPos.x - 1, y: cellPos.y};\n    const top2 = {x: cellPos.x - 2, y: cellPos.y};\n    const bottom1 = {x: cellPos.x + 1, y: cellPos.y};\n    const bottom2 = {x: cellPos.x + 2, y: cellPos.y};\n\n    const left1 = {x: cellPos.x, y: cellPos.y - 1};\n    const left2 = {x: cellPos.x, y: cellPos.y - 2};\n    const right1 = {x: cellPos.x, y: cellPos.y + 1};\n    const right2 = {x: cellPos.x, y: cellPos.y + 2};\n    \n    // Check horizontal match with this cell in left.\n    if (board.doCandiesMatch (cellPos, right1) && board.doCandiesMatch(cellPos, right2)) {\n        return true;\n    }\n\n    // Check if horizontal match with this cell in middle.\n    if (board.doCandiesMatch (cellPos, left1) && board.doCandiesMatch(cellPos, right1)) {\n        return true;\n    }\n\n    // Check if horizontal match with this cell in right.\n    if (board.doCandiesMatch (cellPos, left1) && board.doCandiesMatch(cellPos, left2)) {\n        return true;\n    }\n    \n    // Check if vertical match with this cell in top.\n    if (board.doCandiesMatch (cellPos, bottom1) && board.doCandiesMatch(cellPos, bottom2)) {\n        return true;\n    }\n\n    // Check if vertical match with this cell in middle.\n    if (board.doCandiesMatch (cellPos, top1) && board.doCandiesMatch(cellPos, bottom1)) {\n        return true;\n    }\n    \n    // Check if vertical match with this cell in bottom.\n    if (board.doCandiesMatch (cellPos, top1) && board.doCandiesMatch(cellPos, top2)) {\n        return true;\n    }\n    \n    return false;\n}\n\n// Temporarily commenting this class. Will be implementing this later when developing animations.\n// For now, use the simple version above.\n/*\nexport class GravityHandler {\n    private board: Board;\n\n    constructor(board: Board) {\n        this.board = board;\n\n        EventBus.applyGravity.add (this.applyGravityToBoard.bind (this));\n        EventBus.updateBoard.add (this.handleAddBoard.bind (this));\n    }\n\n    handleAddBoard (board: Board) {\n        this.board = board;\n    }\n\n    async applyGravityToBoard () {\n        console.log(\"Moving candies down\");\n        await delay(1000);\n        const col = 8;\n\n        for (let i = 0; i < COLUMNS; ++i) {\n            if (i == col) console.log(\"Scanning col\", i);\n            \n            // Pointers to store start and end point of empty cells.\n            let emptyStart = 0;\n            let emptyEnd = 0;\n            let rowNo = 0;\n\n            // Find start point of empty cells.\n            while (this.board.getColorAtCell({x: rowNo, y: i}) !== 'EMPTY') {\n                if (i == col) console.log(\"  Not empty at\", rowNo);\n                ++rowNo;\n\n                if (rowNo >= ROWS) break;\n            }\n\n            emptyStart = rowNo;\n            if (i == col) console.log(\"Set empty start\", emptyStart);\n            \n\n            // Find end point of empty cells.\n            while (this.board.getColorAtCell({x: rowNo, y: i}) === 'EMPTY') {\n                if (i == col) console.log(\"  Still empty at\", rowNo);\n                ++rowNo;\n\n                if (rowNo >= ROWS) break;\n            }\n\n            emptyEnd = rowNo - 1;\n            if (i == col) console.log(\"Set empty end \", emptyEnd);\n\n            // If there are no empty cells.\n            if (emptyStart == ROWS && emptyEnd == ROWS) continue;\n\n            // Based on the start and end positions, create array of new candies to slide down.\n            const slideCandies: HTMLImageElement[] = [];\n            \n            // Now generate as many random candies as there are empty cells and add to list.\n            for (let j = emptyStart; j < emptyEnd + 1; ++j) {\n                if (i == col) console.log(\"Empty cell :: Random\");\n                slideCandies.push (this.board.sourceCells[i].generateRandomCandy().image);\n            }\n\n            // First add candies before empty block to this list.\n            for (let j = 0; j < emptyStart; ++j) {\n                const pos = {x: j, y: i};\n                if (i == col) console.log(\"Empty cell\", pos, this.board.getImageAtCell(pos));\n                slideCandies.push(this.board.getImageAtCell(pos));\n            }\n\n            console.log(\"Candies\", slideCandies);\n            console.log();\n\n            // Emit signal to apply gravity.\n            EventBus.renderGravityAnimation.emit({\n                images: slideCandies.reverse(),\n                startPoint: {x: emptyStart, y: i}\n            });\n\n            // Wait for animaition to complete.\n            await delay(600);\n        }\n    }\n}\n*/\n","import { CandyMatchHandler } from \"./controllers/CandyMatchHandler\";\nimport { EventHandler } from \"./controllers/EventHandler\";\nimport { SwapHandler } from \"./controllers/SwapHandler\";\nimport { Board } from \"./models/Board\";\nimport { CanvasView } from \"./views/CanvasView\";\nimport { delay } from './setup';\nimport { CandyDestroyer } from \"./controllers/CandyDestroyer\";\nimport { GravityHandler } from \"./controllers/GravityHandler\";\n\nasync function main(): Promise<void> {\n    const baseCanvas = new CanvasView('playField');\n    const board = new Board();\n\n    const eventHandler =  new EventHandler(baseCanvas);\n    const swapHandler = new SwapHandler(board);\n    const candyMatchHandler = new CandyMatchHandler();\n    const candyDestroyer = new CandyDestroyer();\n    const gravityHandler = new GravityHandler(board);\n\n    await delay(500);\n    baseCanvas.drawBoard(board);\n}\n\nmain ();"]}